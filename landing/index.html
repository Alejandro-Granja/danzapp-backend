<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DanzApp – Catálogo de Danzas Tradicionales</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;800&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/styles.css">
  <style>
    :root { --brand:#E63946; --ink:#0f172a; }
    body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color: var(--ink); }
    .headline { font-family: Montserrat, Inter, sans-serif; }
    .line-clamp-3 { display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden; }
    .chip { @apply px-3 py-1.5 rounded-full border text-sm hover:bg-slate-100 cursor-pointer; }
    
  </style>
</head>
<body class="bg-white">
  <!-- Navbar -->
  <header class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b">
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <a href="#" class="flex items-center gap-2">
        <span class="inline-block w-8 h-8 rounded-full bg-[var(--brand)]"></span>
        <span class="headline text-xl font-extrabold">DanzApp</span>
      </a>
      <ul class="hidden md:flex items-center gap-6 text-sm">
        <li><a class="hover:text-[var(--brand)]" href="#inicio">Inicio</a></li>
        <li><a class="hover:text-[var(--brand)]" href="#catalogo">Catálogo</a></li>
        <li><a class="hover:text-[var(--brand)]" href="#acerca">Acerca</a></li>
        <li><a class="hover:text-[var(--brand)]" href="#contacto">Contacto</a></li>
      </ul>
      <div class="flex items-center gap-2">
        <a href="./login.html" class="text-sm px-3 py-2 rounded hover:bg-slate-100">Iniciar sesión</a>
        <a href="./register.html" class="text-sm px-3 py-2 rounded bg-[var(--brand)] text-white hover:opacity-90">Registrarse</a>
      </div>
    </nav>
  </header>

  <!-- Hero -->
  <section id="inicio" class="relative">
    <div class="absolute inset-0 -z-10">
      <img src="assets/img/hero.jpg" alt="Danzas tradicionales" class="w-full h-[52vh] md:h-[64vh] object-cover">
      <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-black/10"></div>
    </div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-[52vh] md:h-[64vh] flex items-end">
      <div class="pb-10 text-white">
        <h1 class="headline text-4xl md:text-6xl font-extrabold">Ritmos que cuentan nuestra historia</h1>
        <p class="mt-3 text-lg md:text-xl max-w-2xl">Explora danzas como Mapalé, Currulao, Joropo y Cumbia. Aprende su origen, región y significado cultural.</p>
        <a href="#catalogo" class="mt-6 inline-block px-5 py-3 rounded bg-white/90 text-slate-900 hover:bg-white">Explorar danzas</a>
      </div>
    </div>
  </section>

  <!-- Buscador + Filtros -->
  <section id="catalogo" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <div class="flex flex-col md:flex-row md:items-center gap-4 md:gap-6">
      <div class="flex-1">
        <label class="block text-sm font-medium mb-2">Buscar danza</label>
        <input id="q" type="search" placeholder="Ej: Currulao, Mapalé…" class="w-full border rounded px-3 h-11 focus:outline-none focus:ring-2 focus:ring-[var(--brand)]" />
      </div>
      <div class="w-full md:w-64">
        <label class="block text-sm font-medium mb-2">Región</label>
        <select id="region" class="w-full border rounded px-3 h-11 focus:outline-none focus:ring-2 focus:ring-[var(--brand)]">
          <option value="">Todas</option>
          <option>Pacífico</option>
          <option>Caribe</option>
          <option>Andina</option>
          <option>Llanos</option>
          <option>Amazonía</option>
        </select>
      </div>
      <button id="btnBuscar" class="h-11 px-4 rounded bg-[var(--brand)] text-white hover:opacity-90">Filtrar</button>
    </div>

    <!-- Chips de categorías -->
    <div class="mt-6 flex flex-wrap gap-2">
      <button class="chip" data-cat="">Todas</button>
      <button class="chip" data-cat="Mapalé">Mapalé</button>
      <button class="chip" data-cat="Currulao">Currulao</button>
      <button class="chip" data-cat="Cumbia">Cumbia</button>
      <button class="chip" data-cat="Joropo">Joropo</button>
    </div>

    <!-- Grid de tarjetas -->
    <div id="gridDanzas" class="mt-8 grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      <!-- JS render -->
    </div>
  </section>

  <!-- Acerca -->
  <section id="acerca" class="bg-slate-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <h2 class="headline text-3xl font-extrabold">Acerca del proyecto</h2>
      <p class="mt-3 max-w-3xl">DanzApp es un catálogo digital para difundir y preservar danzas tradicionales colombianas. Pensado para estudiantes, docentes e investigadores culturales.</p>
    </div>
  </section>

  <!-- Contacto -->
  <section id="contacto">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <h2 class="headline text-3xl font-extrabold">Contacto</h2>
      <ul class="mt-3 list-disc pl-6">
        <li><a class="underline" target="_blank" href="#">Instagram del proyecto</a></li>
        <li><a class="underline" target="_blank" href="#">YouTube del proyecto</a></li>
      </ul>
    </div>
  </section>

  <!-- Footer -->
  <footer class="border-t">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between text-sm">
      <span>© 2025 DanzApp</span>
      <a class="underline" href="./admin.html">Panel administrador</a>
    </div>
  </footer>

  <!-- Modal Detalle -->
  <div id="modal" class="fixed inset-0 hidden items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/60" onclick="cerrarModal()"></div>
    <article class="relative z-10 bg-white max-w-2xl w-full rounded-xl shadow-xl overflow-hidden">
      <div class="grid md:grid-cols-2">
        <img id="m_img" alt="" class="w-full h-64 md:h-full object-cover">
        <div class="p-6">
          <h3 id="m_titulo" class="headline text-2xl font-extrabold"></h3>
          <p id="m_region" class="text-sm text-slate-600 mt-1"></p>
          <p id="m_desc" class="mt-4"></p>
          <p id="m_origen" class="mt-3 text-sm text-slate-700"></p>
          <a id="m_video" class="mt-4 inline-block underline" target="_blank">Ver video</a>
        </div>
      </div>
      <button class="absolute top-3 right-3 bg-white/90 rounded-full w-9 h-9" onclick="cerrarModal()">✕</button>
    </article>
  </div>

  <script>
    const API = "http://localhost:3000/api/danzas";

    const state = { danzas: [], filtroTexto: "", filtroRegion: "", filtroCat: "" };

    async function cargar() {
      try {
        const res = await fetch(API);
        state.danzas = await res.json();
      } catch {
        // fallback de demo si el backend no está corriendo
        state.danzas = [
          { id:"1", nombre:"Currulao", region:"Pacífico", imagenUrl:"assets/img/currulao.jpg", descripcion:"Danza afro del Pacífico con marimba.", origen:"Herencia africana", videoUrl:"" },
          { id:"2", nombre:"Mapalé", region:"Caribe", imagenUrl:"assets/img/mapale.jpg", descripcion:"Ritmo enérgico de la costa Caribe.", origen:"Raíces africanas", videoUrl:"" },
          { id:"3", nombre:"Cumbia", region:"Caribe", imagenUrl:"assets/img/cumbia.jpg", descripcion:"Símbolo musical y dancístico de Colombia.", origen:"Mestizaje indígena, africano y español", videoUrl:"" },
          { id:"4", nombre:"Joropo", region:"Llanos", imagenUrl:"assets/img/joropo.jpg", descripcion:"Zapateo y arpa llanera.", origen:"Tradición llanera", videoUrl:"" }
        ];
      }
      render();
    }

    function aplicarFiltros(arr) {
      return arr.filter(d => {
        const txt = state.filtroTexto.trim().toLowerCase();
        const okTxt = !txt || d.nombre.toLowerCase().includes(txt) || (d.descripcion||"").toLowerCase().includes(txt);
        const okRegion = !state.filtroRegion || d.region === state.filtroRegion;
        const okCat = !state.filtroCat || d.nombre.toLowerCase().includes(state.filtroCat.toLowerCase());
        return okTxt && okRegion && okCat;
      });
    }

    function render() {
      const grid = document.getElementById("gridDanzas");
      const items = aplicarFiltros(state.danzas);
      grid.innerHTML = items.map(d => `
        <article class="border rounded-xl overflow-hidden hover:shadow transition">
          <img src="${d.imagenUrl || 'assets/img/placeholder.jpg'}" alt="${d.nombre}" class="w-full h-44 object-cover">
          <div class="p-4">
            <h3 class="text-lg font-semibold">${d.nombre}</h3>
            <p class="text-sm text-slate-600">${d.region}</p>
            <p class="mt-2 text-sm line-clamp-3">${d.descripcion || ""}</p>
            <button class="mt-3 text-[var(--brand)] underline" onclick='ver(${JSON.stringify(d)})'>Ver más</button>
          </div>
        </article>
      `).join("");
    }

    function ver(d) {
      document.getElementById("m_img").src = d.imagenUrl || "assets/img/placeholder.jpg";
      document.getElementById("m_titulo").textContent = d.nombre;
      document.getElementById("m_region").textContent = d.region;
      document.getElementById("m_desc").textContent = d.descripcion || "";
      document.getElementById("m_origen").textContent = d.origen ? "Origen: " + d.origen : "";
      const a = document.getElementById("m_video");
      if (d.videoUrl) { a.href = d.videoUrl; a.classList.remove("pointer-events-none","opacity-50"); }
      else { a.href = "#"; a.classList.add("pointer-events-none","opacity-50"); }
      document.getElementById("modal").classList.remove("hidden");
      document.getElementById("modal").classList.add("flex");
    }
    function cerrarModal() {
      document.getElementById("modal").classList.add("hidden");
      document.getElementById("modal").classList.remove("flex");
    }

    // Interacciones
    document.getElementById("btnBuscar").addEventListener("click", () => {
      state.filtroTexto = document.getElementById("q").value;
      state.filtroRegion = document.getElementById("region").value;
      render();
    });
    document.querySelectorAll(".chip").forEach(ch => ch.addEventListener("click", () => {
      state.filtroCat = ch.dataset.cat || "";
      render();
    }));

    // Init
    window.addEventListener("DOMContentLoaded", cargar);
  </script>
</body>
</html>
